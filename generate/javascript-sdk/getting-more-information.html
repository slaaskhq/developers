<main class="container-fluid">
  <div class="row">

    <!-- Main content -->
    <article class="main-content" role="main">

      <header>
        <h1>Gathering more information about your visitors</h1>
      </header>

      <section>
        <p>These instructions will walk you through the installation of Slaask on your site for <b>logged-in users of your product</b>. With this feature, you can track account data and have conversations with your users via Slaask.</p>

        <p>The basic Javascript method is a good fit for most standard web apps, which are characterized by each new page view triggering a full page refresh.</p>

        <p>Copy and paste this code snippet before the <code>&lt;/body&gt;</code> tag on every page where you would like Slaask to appear for logged-in users.</p>

        <div class="code-window">
          <div class="window-bar">
            <div class="circles">
              <span class="circle circle-red"></span> <span class="circle circle-yellow"></span> <span class="circle circle-green"></span>
            </div>
            <div class="languages">
              <div class="btn-group" data-toggle="buttons">
                <label class="btn-javascript btn active">javascript</label>
                <label class="btn-async btn">JS (async)</label>
                <label class="btn-rails btn">ruby (rails)</label>
                <label class="btn-django btn">python (django)</label>
                <label class="btn-php btn">php</label>
              </div>
            </div>
          </div>

          <div class="window-content">
            <pre class="javascript line-numbers" data-language="markup">

&lt;script src='https://cdn.slaask.com/chat.js'&gt;&lt;/script&gt;

&lt;script&gt;
    _slaask.identify(<span class="token property">'JackieChan'</span>, {
        user_id: <span class="token property">1234</span>,
        email: <span class="token property">'jackie@chan.com'</span>,
        speciality: <span class="token property">'martial artist'</span>
    });

    _slaask.init('<span class="token blue-property replace-with-api-key replace-with-api-key">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>', { visitor_token: <span class="token property">'a-unique-visitor-attribute'</span> });
&lt;/script&gt;
            </pre>

            <pre class="async line-numbers hidden" data-language="markup">

&lt;script&gt;
  (function() {
    var slk = document.createElement('script');
    slk.src = 'https://cdn.slaask.com/chat.js';
    slk.type = 'text/javascript';
    slk.async = 'true';
    slk.onload = slk.onreadystatechange = function() {
      var rs = this.readyState;
      if (rs && rs != 'complete' && rs != 'loaded') return;
      try {
        _slaask.identify(<span class="token property">'UserName'</span>, {
          user_id: <span class="token property">1234</span>,
          email: <span class="token property">'firstname@company.com'</span>,
          plan: <span class="token property">'enterprise'</span>
        });
        _slaask.init('<span class="token blue-property replace-with-api-key">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>', { visitor_token: <span class="token property">'a-unique-visitor-attribute'</span> });
      } catch (e) {}
    };
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(slk, s);
  })();
&lt;/script&gt;
            </pre>

            <pre class="rails line-numbers hidden">

&lt;script src='https://cdn.slaask.com/chat.js'&gt;&lt;/script&gt;

&lt;% if user_signed_in? %&gt;
  &lt;script&gt;
    _slaask.identify('<span class="token property">&lt;%= current_user.firstname %&gt;</span>', {
      user_id: <span class="token property">&lt;%= current_user.id %&gt;</span>,
      email: '<span class="token property">&lt;%= current_user.email %&gt;</span>',
      speciality: '<span class="token property">&lt;%= current_user.speciality %&gt;</span>'
    });

    _slaask.init('<span class="token blue-property replace-with-api-key">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>', { visitor_token: '<span class="token property">&lt;%= current_user.id %&gt;</span>' });
  &lt;/script&gt;
&lt;% else %&gt;
  &lt;script&gt;
    _slaask.init('<span class="token blue-property replace-with-api-key">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>');
  &lt;/script&gt;
&lt;% end %&gt;
            </pre>

            <pre class="django line-numbers hidden">

&lt;script src='https://cdn.slaask.com/chat.js'&gt;&lt;/script&gt;

{% if request.user.logged_in %}
  &lt;script&gt;
    _slaask.identify('<span class="token property">{{ current_user.firstname }}</span>', {
      user_id: <span class="token property">{{ current_user.id }}</span>,
      email: '<span class="token property">{{ current_user.email }}</span>',
      speciality: '<span class="token property">{{ current_user.speciality }}</span>'
    });

    _slaask.init('<span class="token blue-property replace-with-api-key">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>', { visitor_token: '<span class="token property">{{ current_user.id }}</span>' });
  &lt;/script&gt;
{% else %}
  &lt;script&gt;
    _slaask.init('<span class="token blue-property replace-with-api-key">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>');
  &lt;/script&gt;
{% endif %}
            </pre>

            <pre class="php line-numbers hidden">

&lt;script src='https://cdn.slaask.com/chat.js'&gt;&lt;/script&gt;

&lt;?php if (isset($current_user)): ?&gt;
  &lt;script&gt;
    _slaask.identify('<span class="token property">&lt;?php echo $current_user->firstname ?&gt;</span>', {
      user_id: <span class="token property">&lt;?php echo $current_user->id ?&gt;</span>,
      email: '<span class="token property">&lt;?php echo $current_user->email ?&gt;</span>',
      speciality: '<span class="token property">&lt;?php echo $current_user->speciality ?&gt;</span>'
    });

    _slaask.init('<span class="token blue-property replace-with-api-key">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>', { visitor_token: '<span class="token property">&lt;?php echo $current_user->id ?&gt;</span>' });
  &lt;/script&gt;
&lt;?php else: ?&gt;
  &lt;script&gt;
    _slaask.init('<span class="token blue-property replace-with-api-key">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>');
  &lt;/script&gt;
&lt;?php endif; ?&gt;
            </pre>
          </div>
        </div>

        <p>Make sure you replace the user data example (<u class="hover-swag">highlighted in <span class="token property">pink</span></u>) with your own code that inserts real user data for the currently logged-in user on each of your pages.</p>

        <p>Replace <code>a-unique-visitor-attribute</code> <i>(the second attribute of the <code>_slaask.init</code> function)</i> with a <b>UNIQUE</b> identifier for your visitor. This attribute will be used to identify your visitors in order to retrieve their conversation history and information.</p>
      </section>

    </article>
    <!-- END Main content -->
  </div>
</main>

<script>
  window.addEventListener('load', function() {
    setTimeout(function() {
      var hash = document.location.hash.substr(1);
      if (hash) {
        var btn = document.getElementById('btn-' + hash);
        if (btn) {
          btn.click();
        }
      }
    }, 16);
  });
</script>
